<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Formulário - VSM Informática</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --brand:#002b5c;
    --bg:#f6f7fb;
    --card:#ffffff;
    --muted:#6b7280;
  }
  *{box-sizing:border-box;font-family:'Inter',system-ui,Helvetica,Arial,sans-serif}
  body{margin:0;background:var(--bg);color:#111;line-height:1.4}
  header{background:linear-gradient(90deg,var(--brand),#004b8c);color:white;padding:22px 16px;text-align:center}
  header h1{margin:0;font-size:20px}
  header p{margin:6px 0 0;font-size:13px;opacity:0.95}
  main{max-width:980px;margin:26px auto;padding:22px;border-radius:12px;background:var(--card);box-shadow:0 6px 22px rgba(2,6,23,0.06)}
  .grid{display:grid;grid-template-columns:1fr 360px;gap:20px}
  @media(max-width:900px){.grid{grid-template-columns:1fr}}
  .card{padding:16px;border-radius:10px;background:linear-gradient(180deg,rgba(0,0,0,0.02),transparent);border:1px solid rgba(2,6,23,0.04)}
  .choose{display:flex;gap:12px;flex-direction:column}
  .option{padding:14px;border-radius:8px;border:1px solid #e6eefb;background:#fff;cursor:pointer;transition:transform .12s,box-shadow .12s}
  .option:hover{transform:translateY(-4px);box-shadow:0 8px 20px rgba(2,27,68,0.06)}
  .option b{display:block;color:var(--brand)}
  label{display:block;font-weight:600;margin-top:12px;font-size:13px;color:#0b2540}
  input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #d2dbe8;margin-top:6px;font-size:14px}
  button{background:var(--brand);color:#fff;border:none;padding:10px 14px;border-radius:8px;font-weight:700;cursor:pointer}
  .btn-row{display:flex;gap:10px;justify-content:flex-end;margin-top:16px}
  .muted{color:var(--muted);font-size:13px}
  .success{background:#e6ffef;border:1px solid #b7f0cf;color:#0b6b34;padding:10px;border-radius:8px}
  .error{background:#ffecea;border:1px solid #ffbdb5;color:#8a1a1a;padding:10px;border-radius:8px}
</style>
</head>
<body>
<header>
  <h1>VSM Informática Assis LTDA – ME</h1>
  <p>Solicitação de alteração de CNPJ — formulário automático</p>
</header>

<main>
  <div class="grid">
    <div class="card">
      <div id="step1" class="choose">
        <div class="option" onclick="showForm('banco')">
          <b>Via Banco de Dados (sem custo)</b>
          <p class="muted small">Atualiza apenas o CNPJ mantendo dados do cadastro anterior.</p>
        </div>
        <div class="option" onclick="showForm('nova')">
          <b>Nova Loja (novo banco de dados)</b>
          <p class="muted small">Cria nova empresa — importação e taxas opcionais.</p>
        </div>
      </div>

      <form id="banco" style="display:none;" onsubmit="submitForm(event,'banco')">
        <input type="hidden" name="tipo" value="Via Banco de Dados">
        <label>Razão Social<input type="text" name="razao" required></label>
        <label>Nome Fantasia<input type="text" name="fantasia" required></label>
        <label>CNPJ Novo<input type="text" name="cnpj_novo" required></label>
        <div class="btn-row">
          <button type="button" onclick="goBack()">⬅ Voltar</button>
          <button type="submit">Enviar</button>
        </div>
      </form>

      <form id="nova" style="display:none;" onsubmit="submitForm(event,'nova')">
        <input type="hidden" name="tipo" value="Nova Loja">
        <label>Razão Social<input type="text" name="razao2" required></label>
        <label>Nome Fantasia<input type="text" name="fantasia2" required></label>
        <label>CNPJ Novo<input type="text" name="cnpj_novo2" required></label>
        <div class="btn-row">
          <button type="button" onclick="goBack()">⬅ Voltar</button>
          <button type="submit">Enviar</button>
        </div>
      </form>
    </div>

    <aside class="card">
      <h3>Status</h3>
      <div id="status" class="muted">Escolha o tipo de alteração à esquerda e preencha os dados.</div>
    </aside>
  </div>
</main>

<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbytgNbO26VzfMhTxSr4szxQLcYBmI33U5BfMBjVfipSjtZSl-lGXcVo766NOC17xBrODQ/exec";

  function showForm(id){
    document.getElementById('step1').style.display='none';
    document.getElementById('banco').style.display=id==='banco'?'block':'none';
    document.getElementById('nova').style.display=id==='nova'?'block':'none';
    document.getElementById('status').innerText='Preencha e envie.';
  }

  function goBack(){
    document.getElementById('step1').style.display='flex';
    document.getElementById('banco').style.display='none';
    document.getElementById('nova').style.display='none';
    document.getElementById('status').innerText='Escolha uma opção.';
  }

  async function submitForm(e, formId){
    e.preventDefault();
    const form = document.getElementById(formId);
    const data = Object.fromEntries(new FormData(form).entries());

    document.getElementById('status').innerHTML='<div class="muted">Enviando...</div>';

    try {
      const response = await fetch(SCRIPT_URL, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data)
      });
      const json = await response.json();
      console.log(json);

      if (json.ok) {
        document.getElementById('status').innerHTML='<div class="success">✅ Dados enviados com sucesso!</div>';
        form.reset();
        setTimeout(goBack, 2000);
      } else {
        document.getElementById('status').innerHTML='<div class="error">❌ Erro: '+json.error+'</div>';
      }

    } catch (err) {
      document.getElementById('status').innerHTML='<div class="error">Erro de conexão: '+err.message+'</div>';
      console.error(err);
    }
  }
</script>
</body>
</html>
